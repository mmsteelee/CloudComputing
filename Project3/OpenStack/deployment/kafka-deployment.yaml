---
apiVersion: apps/v1
kind: Deployment
metadata: 
  name: kafka-deployment-1
  namespace: kafka-cluster
spec:
  serviceName: kafka1
  replicas: 1
  selector:
    matchLabels:
      app: kafka-broker-1
  template:
    spec:
      nodeSelector: # this shows how you force k8s to schedule the pod on a specified node
        kubernetes.io/hostname: kubeworker2
      containers: 
      - name: kafka
        image: wurstmeister/kafka
        ports:
        - containerPort: 5984
        env:
        - name: KAFKA_ZOOKEEPER_CONNECT
          value: zoo:2181
        - name: KAFKA_BROKER_ID
          value: "0"
        - name: ALLOW_PLAINTEXT_LISTINER
          value: "yes"
        - name: KAFKA_ADVERTISED_LISTENERS
          value: 129.114.26.148:9092

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kafka-deployment-2
  namespace: kafka-cluster
spec:
  serviceName: kafka2
  replicas: 1
  selector:
    matchLabels:
      app: kafka-broker-2
  template:
    spec:
      nodeSelector: # this shows how you force k8s to schedule the pod on a specified node
        kubernetes.io/hostname: kubeworker2
      containers: 
      - name: kafka
        image: wurstmeister/kafka
        ports:
        - containerPort: 5984
        env:
        - name: KAFKA_ZOOKEEPER_CONNECT
          value: zoo:2181
        - name: KAFKA_BROKER_ID
          value: "1"
        - name: ALLOW_PLAINTEXT_LISTINER
          value: "yes"
        - name: KAFKA_ADVERTISED_LISTENERS
          value: 129.114.26.148:9092

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kafka-deployment-3
  namespace: kafka-cluster
spec:
  serviceName: kafka3
  replicas: 1
  selector:
    matchLabels:
      app: kafka-broker-3
  template:
    spec:
      nodeSelector: # this shows how you force k8s to schedule the pod on a specified node
        kubernetes.io/hostname: kubeworker2
      containers: 
      - name: kafka
        image: wurstmeister/kafka
        ports:
        - containerPort: 5984
        env:
        - name: KAFKA_ZOOKEEPER_CONNECT
          value: zoo:2181
        - name: KAFKA_BROKER_ID
          value: "2"
        - name: ALLOW_PLAINTEXT_LISTINER
          value: "yes"
        - name: KAFKA_ADVERTISED_LISTENERS
          value: 129.114.26.148:9092
        - name: KAFKA_CREATE_TOPICS
          value: "utilizations:1:1"

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kafka-deployment-4
  namespace: kafka-cluster
spec:
  serviceName: kafka4
  replicas: 1
  selector:
    matchLabels:
      app: kafka-broker-4
  template:
    spec:
      nodeSelector: # this shows how you force k8s to schedule the pod on a specified node
        kubernetes.io/hostname: kubeworker2
      containers:
        - name: kafka
          image: wurstmeister/kafka
          ports:
            - containerPort: 5984
          env:
            - name: KAFKA_ZOOKEEPER_CONNECT
              value: zoo:2181
            - name: KAFKA_BROKER_ID
              value: "3"
            - name: ALLOW_PLAINTEXT_LISTINER
              value: "yes"
            - name: KAFKA_ADVERTISED_LISTENERS
              value: 129.114.26.148:9092

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kafka-deployment-5
  namespace: kafka-cluster
spec:
  serviceName: kafka5
  replicas: 1
  selector:
    matchLabels:
      app: kafka-broker-5
  template:
    spec:
      nodeSelector: # this shows how you force k8s to schedule the pod on a specified node
        kubernetes.io/hostname: kubeworker2
      containers:
        - name: kafka
          image: wurstmeister/kafka
          ports:
            - containerPort: 5984
          env:
            - name: KAFKA_ZOOKEEPER_CONNECT
              value: zoo:2181
            - name: KAFKA_BROKER_ID
              value: "4"
            - name: ALLOW_PLAINTEXT_LISTINER
              value: "yes"
            - name: KAFKA_ADVERTISED_LISTENERS
              value: 129.114.26.148:9092
...